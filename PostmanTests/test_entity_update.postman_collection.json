{
	"info": {
		"_postman_id": "b2050fae-4a9d-4bdc-9518-f7c9fcc31c2e",
		"name": "FIWARE API Tests: Entity Update",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "29792673",
		"_collection_link": "https://interstellar-capsule-568930.postman.co/workspace/FIWARE-Workspace~e6ef974a-b2f9-4aff-833a-e9152de87458/collection/29792673-b2050fae-4a9d-4bdc-9518-f7c9fcc31c2e?action=share&source=collection_link&creator=29792673"
	},
	"item": [
		{
			"name": "SetUp: Batch Create/Overwrite New Data Entities",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"\r",
							"pm.test(\"Response status code is 204\", function () {\r",
							"  pm.response.to.have.status(204);\r",
							"});\r",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					},
					{
						"key": "fiware-service",
						"value": "{{fiware_service}}",
						"type": "text"
					},
					{
						"key": "fiware-servicepath",
						"value": "{{fiware_service_path}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"actionType\":\"append\",\n  \"entities\":[\n    {\n        \"id\": \"{{first_product_id}}\",\n        \"type\": \"{{product_type}}\",\n        \"name\": { \"type\": \"Text\", \"value\": \"Apples\", \"metadata\": {} },\n        \"offerPrice\": { \"type\": \"Integer\", \"value\": 89, \"metadata\": {} },\n        \"price\": { \"type\": \"Integer\", \"value\": 99, \"metadata\": {} },\n        \"size\": { \"type\": \"Text\", \"value\": \"S\", \"metadata\": {} },\n        \"specialOffer\": { \"type\": \"Boolean\", \"value\": true, \"metadata\": {} }\n    },\n    {\n        \"id\": \"{{second_product_id}}\",\n        \"type\": \"{{product_type}}\",\n        \"name\": { \"type\": \"Text\", \"value\": \"Bananas\", \"metadata\": {} },\n        \"price\": { \"type\": \"Integer\", \"value\": 1099, \"metadata\": {} },\n        \"size\": { \"type\": \"Text\", \"value\": \"M\", \"metadata\": {} }\n    },\n    {\n        \"id\": \"{{third_product_id}}\",\n        \"type\": \"{{product_type}}\",\n        \"name\": { \"type\": \"Text\", \"value\": \"Coconuts\", \"metadata\": {} },\n        \"price\": { \"type\": \"Integer\", \"value\": 1499, \"metadata\": {} },\n        \"size\": { \"type\": \"Text\", \"value\": \"M\", \"metadata\": {} }\n    }\n]\n}"
				},
				"url": {
					"raw": "{{protocol}}://{{orion}}/v2/op/update",
					"protocol": "{{protocol}}",
					"host": [
						"{{orion}}"
					],
					"path": [
						"v2",
						"op",
						"update"
					]
				},
				"description": "This example uses the convenience batch processing endpoint to adds or ammend two **Product** entities and one attribute (`offerPrice`) to the context.\n\n* if the entities already exist - the request will update the attributes of an entity. \n\n* if the entities do not exist, a new entity will be created.\n\n\nBatch processing uses the `/v2/op/update` endpoint with a payload with two attributes:\n* `actionType=append` means we will overwrite existing entities if they exist\n* The `entities` attribute holds an array of entities we wish to create/overwrite.\n\nEach product has a unique `id` following the NGSI-LD  [draft recommendation](https://docbox.etsi.org/ISG/CIM/Open/ISG_CIM_NGSI-LD_API_Draft_for_public_review.pdf)  and has been assigned `type=Product`.\n\n---\nSubsequent request using the same data with the `actionType=append` batch operation  can applied without changing the result beyond the initial application."
			},
			"response": []
		},
		{
			"name": "Getting all Entities",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"",
							"pm.test(\"Response status code is 200\", function () {",
							"  pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"The response data array length must be 3\", function () {",
							"    responseData = pm.response.json();",
							"    pm.expect(responseData.length).to.be.equal(3)",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"protocolProfileBehavior": {
				"disableBodyPruning": true
			},
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "fiware-service",
						"value": "{{fiware_service}}",
						"type": "text"
					},
					{
						"key": "fiware-servicepath",
						"value": "{{fiware_service_path}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": ""
				},
				"url": {
					"raw": "{{protocol}}://{{orion}}/v2/entities",
					"protocol": "{{protocol}}",
					"host": [
						"{{orion}}"
					],
					"path": [
						"v2",
						"entities"
					]
				}
			},
			"response": []
		},
		{
			"name": "Overwrite the value of a single Attribute",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Response status code is 204\", function () {\r",
							"  pm.response.to.have.status(204);\r",
							"});\r",
							"\r",
							"pm.sendRequest({url: pm.variables.get(\"orion\") + \"/v2/entities/\" + pm.variables.get(\"first_product_id\"), header: {\"fiware-service\": pm.variables.get(\"fiware_service\"), \"fiware-servicepath\": pm.variables.get(\"fiware_service_path\")}}, function (err, response) {\r",
							"    console.log(response);\r",
							"    \r",
							"    pm.test(\"Checking the price value of the first product\", function () {\r",
							"        pm.expect(response.json()[\"price\"][\"value\"]).to.be.equal(89);\r",
							"    });\r",
							"});\r",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "Content-Type",
						"value": "text/plain",
						"type": "text"
					},
					{
						"key": "fiware-service",
						"value": "{{fiware_service}}",
						"type": "text"
					},
					{
						"key": "fiware-servicepath",
						"value": "{{fiware_service_path}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "89"
				},
				"url": {
					"raw": "{{protocol}}://{{orion}}/v2/entities/{{first_product_id}}/attrs/price/value",
					"protocol": "{{protocol}}",
					"host": [
						"{{orion}}"
					],
					"path": [
						"v2",
						"entities",
						"{{first_product_id}}",
						"attrs",
						"price",
						"value"
					]
				},
				"description": "This example updates the value of the `price` attribute of the Entity with `id=urn:ngsi-ld:Product:001`\n\nExisiting attribute values can be altered by making a PUT request to the `/v2/entities/<entity>/attrs/<attribute>/value` endpoint."
			},
			"response": []
		},
		{
			"name": "Overwrite the value of multiple Attributes",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"\r",
							"pm.test(\"Response status code is 204\", function () {\r",
							"  pm.response.to.have.status(204);\r",
							"});\r",
							"\r",
							"pm.sendRequest({url: pm.variables.get(\"orion\") + \"/v2/entities/\" + pm.variables.get(\"first_product_id\"), header: {\"fiware-service\": pm.variables.get(\"fiware_service\"), \"fiware-servicepath\": pm.variables.get(\"fiware_service_path\")}}, function (err, response) {\r",
							"    pm.test(\"Checking the value of price and name of the first product\", function () {\r",
							"        pm.expect(response.json()[\"price\"][\"value\"]).to.be.equal(79);\r",
							"        pm.expect(response.json()[\"name\"][\"value\"]).to.be.equal(\"Ale\");\r",
							"    });\r",
							"});\r",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "PATCH",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					},
					{
						"key": "fiware-service",
						"value": "{{fiware_service}}",
						"type": "text"
					},
					{
						"key": "fiware-servicepath",
						"value": "{{fiware_service_path}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": " {\n      \"price\":{\"type\":\"Integer\", \"value\": 79},\n      \"name\": {\"type\":\"Text\", \"value\": \"Ale\"}\n}"
				},
				"url": {
					"raw": "{{protocol}}://{{orion}}/v2/entities/{{first_product_id}}/attrs",
					"protocol": "{{protocol}}",
					"host": [
						"{{orion}}"
					],
					"path": [
						"v2",
						"entities",
						"{{first_product_id}}",
						"attrs"
					]
				},
				"description": "This example simultaneously updates the values of both the `price` and `name` attributes of the Entity with `id=urn:ngsi-ld:Product:001`\n\nMultiple Existing attribute values can be updated by making a PATCH request to the `/v2/entities/<entity>/attrs` endpoint."
			},
			"response": []
		},
		{
			"name": "Overwrite the type of a single Attribute",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"\r",
							"pm.test(\"Response status code is 204\", function () {\r",
							"  pm.response.to.have.status(204);\r",
							"});\r",
							"\r",
							"pm.sendRequest({url: pm.variables.get(\"orion\") + \"/v2/entities/\" + pm.variables.get(\"first_product_id\"), header: {\"fiware-service\": pm.variables.get(\"fiware_service\"), \"fiware-servicepath\": pm.variables.get(\"fiware_service_path\")}}, function (err, response) {\r",
							"    pm.test(\"Checking the price value and type of the first product\", function () {\r",
							"        pm.expect(response.json()[\"price\"][\"value\"]).to.be.equal(\"79\");\r",
							"        pm.expect(response.json()[\"price\"][\"type\"]).to.be.equal(\"String\");\r",
							"    });\r",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "PATCH",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					},
					{
						"key": "fiware-service",
						"value": "{{fiware_service}}",
						"type": "text"
					},
					{
						"key": "fiware-servicepath",
						"value": "{{fiware_service_path}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n      \"price\": {\"type\":\"String\", \"value\": \"79\"}\n}"
				},
				"url": {
					"raw": "{{protocol}}://{{orion}}/v2/entities/{{first_product_id}}/attrs",
					"protocol": "{{protocol}}",
					"host": [
						"{{orion}}"
					],
					"path": [
						"v2",
						"entities",
						"{{first_product_id}}",
						"attrs"
					]
				},
				"description": "This example simultaneously updates the values of both the `price` and `name` attributes of the Entity with `id=urn:ngsi-ld:Product:001`\n\nMultiple Existing attribute values can be updated by making a PATCH request to the `/v2/entities/<entity>/attrs` endpoint."
			},
			"response": []
		},
		{
			"name": "Overwrite the type of multiple Attributes",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"\r",
							"pm.test(\"Response status code is 204\", function () {\r",
							"  pm.response.to.have.status(204);\r",
							"});\r",
							"\r",
							"pm.sendRequest({url: pm.variables.get(\"orion\") + \"/v2/entities/\" + pm.variables.get(\"first_product_id\"), header: {\"fiware-service\": pm.variables.get(\"fiware_service\"), \"fiware-servicepath\": pm.variables.get(\"fiware_service_path\")}}, function (err, response) {\r",
							"    pm.test(\"Checking the value and type of price and name of the first product\", function () {\r",
							"        pm.expect(response.json()[\"price\"][\"value\"]).to.be.equal(79);\r",
							"        pm.expect(response.json()[\"price\"][\"type\"]).to.be.equal(\"Number\");\r",
							"        pm.expect(response.json()[\"name\"][\"value\"]).to.be.equal(\"Ale\");\r",
							"        pm.expect(response.json()[\"name\"][\"type\"]).to.be.equal(\"String\");\r",
							"    });\r",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "PATCH",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					},
					{
						"key": "fiware-service",
						"value": "{{fiware_service}}",
						"type": "text"
					},
					{
						"key": "fiware-servicepath",
						"value": "{{fiware_service_path}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": " {\n      \"price\": {\"value\": 79},\n      \"name\": {\"type\":\"String\", \"value\": \"Ale\"}\n}"
				},
				"url": {
					"raw": "{{protocol}}://{{orion}}/v2/entities/{{first_product_id}}/attrs",
					"protocol": "{{protocol}}",
					"host": [
						"{{orion}}"
					],
					"path": [
						"v2",
						"entities",
						"{{first_product_id}}",
						"attrs"
					]
				},
				"description": "This example simultaneously updates the values of both the `price` and `name` attributes of the Entity with `id=urn:ngsi-ld:Product:001`\n\nMultiple Existing attribute values can be updated by making a PATCH request to the `/v2/entities/<entity>/attrs` endpoint."
			},
			"response": []
		},
		{
			"name": "Delete an Attribute from a Data Entity",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"\r",
							"pm.test(\"Response status code is 204\", function () {\r",
							"  pm.response.to.have.status(204);\r",
							"});\r",
							"\r",
							"pm.sendRequest({url: pm.variables.get(\"orion\") + \"/v2/entities/\" + pm.variables.get(\"first_product_id\"), header: {\"fiware-service\": pm.variables.get(\"fiware_service\"), \"fiware-servicepath\": pm.variables.get(\"fiware_service_path\")}}, function (err, response) {\r",
							"    pm.test(\"Check if specialOffer of the first product got deleted\", function () {\r",
							"        pm.expect(response.json()[\"specialOffer\"]).to.be.undefined\r",
							"    });\r",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "DELETE",
				"header": [
					{
						"key": "fiware-service",
						"value": "{{fiware_service}}",
						"type": "text"
					},
					{
						"key": "fiware-servicepath",
						"value": "{{fiware_service_path}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": ""
				},
				"url": {
					"raw": "{{protocol}}://{{orion}}/v2/entities/{{first_product_id}}/attrs/specialOffer",
					"protocol": "{{protocol}}",
					"host": [
						"{{orion}}"
					],
					"path": [
						"v2",
						"entities",
						"{{first_product_id}}",
						"attrs",
						"specialOffer"
					]
				},
				"description": "This example remove the `specialOffer` attribute from the Entity with `id=urn:ngsi-ld:Product:010` \n\nAttributes be deleted by making a DELETE request to the `/v2/entities/<entity>/attrs/<attribute>` endpoint.\n\n---\nIf the attribute does not exist in the context, the result in an error response."
			},
			"response": []
		},
		{
			"name": "Batch Delete  Multiple Attributes from a Data Entity",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"\r",
							"pm.test(\"Response status code is 204\", function () {\r",
							"  pm.response.to.have.status(204);\r",
							"});\r",
							"\r",
							"pm.sendRequest({url: pm.variables.get(\"orion\") + \"/v2/entities/\" + pm.variables.get(\"first_product_id\"), header: {\"fiware-service\": pm.variables.get(\"fiware_service\"), \"fiware-servicepath\": pm.variables.get(\"fiware_service_path\")}}, function (err, response) {\r",
							"    pm.test(\"Check if price and name of the first product got deleted\", function () {\r",
							"        pm.expect(response.json()[\"price\"]).to.be.undefined\r",
							"        pm.expect(response.json()[\"name\"]).to.be.undefined\r",
							"    });\r",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					},
					{
						"key": "fiware-service",
						"value": "{{fiware_service}}",
						"type": "text"
					},
					{
						"key": "fiware-servicepath",
						"value": "{{fiware_service_path}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"actionType\":\"delete\",\n  \"entities\":[\n    {\n      \"id\":\"{{first_product_id}}\", \"type\":\"{{product_type}}\",\n      \"price\":{},\n      \"name\": {}\n    }\n  ]\n}"
				},
				"url": {
					"raw": "{{protocol}}://{{orion}}/v2/op/update/",
					"protocol": "{{protocol}}",
					"host": [
						"{{orion}}"
					],
					"path": [
						"v2",
						"op",
						"update",
						""
					]
				},
				"description": "This example uses the convenience batch processing endpoint to delete a series of attributes from  an available product.\n\nBatch processing uses the `/v2/op/update` endpoint with a payload with two attributes - `actionType=delete` means we will\ndelete something from the context and the `entities` attribute holds an array of attributes we wish to update.\n\n---\nIf any attribute does not exist in the context, the result in an error response."
			},
			"response": []
		},
		{
			"name": "Add a New Attribute",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"\r",
							"pm.test(\"Response status code is 204\", function () {\r",
							"  pm.response.to.have.status(204);\r",
							"});\r",
							"\r",
							"pm.sendRequest({url: pm.variables.get(\"orion\") + \"/v2/entities/\" + pm.variables.get(\"first_product_id\"), header: {\"fiware-service\": pm.variables.get(\"fiware_service\"), \"fiware-servicepath\": pm.variables.get(\"fiware_service_path\")}}, function (err, response) {\r",
							"    pm.test(\"Checking the value and type of specialOffer of the first product\", function () {\r",
							"        pm.expect(response.json()[\"specialOffer\"][\"value\"]).to.be.equal(true);\r",
							"        pm.expect(response.json()[\"specialOffer\"][\"type\"]).to.be.equal(\"Boolean\");\r",
							"    });\r",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					},
					{
						"key": "fiware-service",
						"value": "{{fiware_service}}",
						"type": "text"
					},
					{
						"key": "fiware-servicepath",
						"value": "{{fiware_service_path}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n      \"specialOffer\":{\"value\": true}\n}"
				},
				"url": {
					"raw": "{{protocol}}://{{orion}}/v2/entities/{{first_product_id}}/attrs",
					"protocol": "{{protocol}}",
					"host": [
						"{{orion}}"
					],
					"path": [
						"v2",
						"entities",
						"{{first_product_id}}",
						"attrs"
					]
				},
				"description": "This example adds a new `specialOffer` attribute to the existing **Product** entity with `id=urn:ngsi-ld:Product:001`\n\nNew attributes can be added by making a POST request to the `/v2/entities/<entity>/attrs` endpoint. \n\nThe payload should consist of a JSON object holding the attribute names and values as shown. \n\nIf no `type` is specified a default `type` (`Boolean`, `Text` or `Number` or `StructuredValue`) will be assigned.\n\n---\nSubsequent requests using the same `id` will update the value of the attribute in the context"
			},
			"response": []
		},
		{
			"name": "Batch Create New Attributes",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"\r",
							"pm.test(\"Response status code is 204\", function () {\r",
							"  pm.response.to.have.status(204);\r",
							"});\r",
							"\r",
							"pm.sendRequest({url: pm.variables.get(\"orion\") + \"/v2/entities/\" + pm.variables.get(\"first_product_id\"), header: {\"fiware-service\": pm.variables.get(\"fiware_service\"), \"fiware-servicepath\": pm.variables.get(\"fiware_service_path\")}}, function (err, response) {\r",
							"    pm.test(\"Checking the value and type of price and name of the first product\", function () {\r",
							"        pm.expect(response.json()[\"price\"][\"value\"]).to.be.equal(99);\r",
							"        pm.expect(response.json()[\"price\"][\"type\"]).to.be.equal(\"Integer\");\r",
							"        pm.expect(response.json()[\"name\"][\"value\"]).to.be.equal(\"Apples\");\r",
							"        pm.expect(response.json()[\"name\"][\"type\"]).to.be.equal(\"Text\");\r",
							"    });\r",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					},
					{
						"key": "fiware-service",
						"value": "{{fiware_service}}",
						"type": "text"
					},
					{
						"key": "fiware-servicepath",
						"value": "{{fiware_service_path}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"actionType\":\"append_strict\",\n  \"entities\":[\n    {\n      \"id\":\"{{first_product_id}}\", \"type\":\"{{product_type}}\",\n      \"name\": { \"type\": \"Text\", \"value\": \"Apples\", \"metadata\": {} },\n      \"price\": { \"type\": \"Integer\", \"value\": 99, \"metadata\": {} }\n    }\n  ]\n}"
				},
				"url": {
					"raw": "{{protocol}}://{{orion}}/v2/op/update/",
					"protocol": "{{protocol}}",
					"host": [
						"{{orion}}"
					],
					"path": [
						"v2",
						"op",
						"update",
						""
					]
				},
				"description": "This example uses the convenience batch processing endpoint to add two new **Product** entities and one new attribute (`offerPrice`)\nto the context. \n\nThe request will **fail** if any of the attributes already exist in the context.\n\nBatch processing uses the `/v2/op/update` endpoint with a payload with two attributes\n* `actionType=append_strict` means that the request only succeed all entities / attributes are new.\n* The `entities` attribute holds an array of entities we wish to create.\n\nEach product has a unique `id` following the NGSI-LD  [draft recommendation](https://docbox.etsi.org/ISG/CIM/Open/ISG_CIM_NGSI-LD_API_Draft_for_public_review.pdf)  and has been assigned `type=Product`.\n\n---\nSubsequent request using the same data with the `actionType=append_strict` batch operation will result in an error response."
			},
			"response": []
		},
		{
			"name": "Update Metadata of multiple Attributes",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"\r",
							"pm.test(\"Response status code is 204\", function () {\r",
							"  pm.response.to.have.status(204);\r",
							"});\r",
							"\r",
							"pm.sendRequest({url: pm.variables.get(\"orion\") + \"/v2/entities/\" + pm.variables.get(\"first_product_id\"), header: {\"fiware-service\": pm.variables.get(\"fiware_service\"), \"fiware-servicepath\": pm.variables.get(\"fiware_service_path\")}}, function (err, response) {\r",
							"    pm.test(\"Checking the metadata of price and name of the first product\", function () {\r",
							"        pm.expect(response.json()[\"price\"][\"metadata\"]).to.not.be.empty;\r",
							"        pm.expect(response.json()[\"name\"][\"metadata\"]).to.not.be.empty;\r",
							"    });\r",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					},
					{
						"key": "fiware-service",
						"value": "{{fiware_service}}",
						"type": "text"
					},
					{
						"key": "fiware-servicepath",
						"value": "{{fiware_service_path}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"actionType\":\"append\",\n  \"entities\":[\n    {\n      \"id\":\"{{first_product_id}}\", \"type\":\"{{product_type}}\",\n      \"name\": { \"type\": \"Text\", \"value\": \"Apples\", \"metadata\": {\"TimeInstant\": {\n                    \"type\": \"DateTime\",\n                    \"value\": \"2024-04-04T14:08:16.655Z\"}} \n              },\n      \"price\": { \"type\": \"Integer\", \"value\": 99, \"metadata\": {\"TimeInstant\": {\n                    \"type\": \"DateTime\",\n                    \"value\": \"2024-04-04T14:08:16.655Z\"}} \n                }\n    }\n  ]\n}"
				},
				"url": {
					"raw": "{{protocol}}://{{orion}}/v2/op/update/",
					"protocol": "{{protocol}}",
					"host": [
						"{{orion}}"
					],
					"path": [
						"v2",
						"op",
						"update",
						""
					]
				},
				"description": "This example uses the convenience batch processing endpoint to add two new **Product** entities and one new attribute (`offerPrice`)\nto the context. \n\nThe request will **fail** if any of the attributes already exist in the context.\n\nBatch processing uses the `/v2/op/update` endpoint with a payload with two attributes\n* `actionType=append_strict` means that the request only succeed all entities / attributes are new.\n* The `entities` attribute holds an array of entities we wish to create.\n\nEach product has a unique `id` following the NGSI-LD  [draft recommendation](https://docbox.etsi.org/ISG/CIM/Open/ISG_CIM_NGSI-LD_API_Draft_for_public_review.pdf)  and has been assigned `type=Product`.\n\n---\nSubsequent request using the same data with the `actionType=append_strict` batch operation will result in an error response."
			},
			"response": []
		},
		{
			"name": "TearDown: Batch Delete Multiple Data Entities",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"\r",
							"pm.test(\"Response status code is 204\", function () {\r",
							"  pm.response.to.have.status(204);\r",
							"});\r",
							"\r",
							"pm.sendRequest({url: pm.variables.get(\"orion\") + \"/v2/entities\", header: {\"fiware-service\": pm.variables.get(\"fiware_service\"), \"fiware-servicepath\": pm.variables.get(\"fiware_service_path\")}}, function (err, response) {\r",
							"    pm.test(\"Checking if there is no entity anymore\", function () {\r",
							"        pm.expect(response.json()).to.be.empty;\r",
							"    });\r",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					},
					{
						"key": "fiware-service",
						"value": "{{fiware_service}}",
						"type": "text"
					},
					{
						"key": "fiware-servicepath",
						"value": "{{fiware_service_path}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"actionType\":\"delete\",\n  \"entities\":[\n    {\n      \"id\":\"{{first_product_id}}\", \"type\":\"{{product_type}}\"\n    },\n    {\n      \"id\":\"{{second_product_id}}\", \"type\":\"{{product_type}}\"\n    },\n    {\n      \"id\":\"{{third_product_id}}\", \"type\":\"{{product_type}}\"\n    }\n  ]\n}"
				},
				"url": {
					"raw": "{{protocol}}://{{orion}}/v2/op/update/",
					"protocol": "{{protocol}}",
					"host": [
						"{{orion}}"
					],
					"path": [
						"v2",
						"op",
						"update",
						""
					]
				},
				"description": "This example uses the convenience batch processing endpoint to delete a series of available products.\n\nBatch processing uses the `/v2/op/update` endpoint with a payload with two attributes - `actionType=delete` means we will\ndelete something from the context and the `entities` attribute holds the `id` of the entities we wish to update.\n\n---\nIf any entity does not exist in the context, the result in an error response."
			},
			"response": []
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "protocol",
			"value": "http",
			"type": "string"
		},
		{
			"key": "orion",
			"value": "orion:1026",
			"type": "string"
		},
		{
			"key": "fiware_service",
			"value": "postman_tests",
			"type": "string"
		},
		{
			"key": "fiware_service_path",
			"value": "/",
			"type": "string"
		},
		{
			"key": "first_product_id",
			"value": "urn:ngsi-ld:Product:001",
			"type": "string"
		},
		{
			"key": "second_product_id",
			"value": "urn:ngsi-ld:Product:002",
			"type": "string"
		},
		{
			"key": "third_product_id",
			"value": "urn:ngsi-ld:Product:003",
			"type": "string"
		},
		{
			"key": "product_type",
			"value": "Product",
			"type": "string"
		}
	]
}